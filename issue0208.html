<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>C issue 0208: Ambiguity in initialization</title>
<style>
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #ffffcc }
.c { color: #3D7B7B; font-style: italic } /* Comment */
.err { border: 1px solid #FF0000 } /* Error */
.k { color: #008000; font-weight: bold } /* Keyword */
.o { color: #666666 } /* Operator */
.ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.cp { color: #9C6500 } /* Comment.Preproc */
.cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.gd { color: #A00000 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.gr { color: #E40000 } /* Generic.Error */
.gh { color: #000080; font-weight: bold } /* Generic.Heading */
.gi { color: #008400 } /* Generic.Inserted */
.go { color: #717171 } /* Generic.Output */
.gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.gt { color: #0044DD } /* Generic.Traceback */
.kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.kp { color: #008000 } /* Keyword.Pseudo */
.kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.kt { color: #B00040 } /* Keyword.Type */
.m { color: #666666 } /* Literal.Number */
.s { color: #BA2121 } /* Literal.String */
.na { color: #687822 } /* Name.Attribute */
.nb { color: #008000 } /* Name.Builtin */
.nc { color: #0000FF; font-weight: bold } /* Name.Class */
.no { color: #880000 } /* Name.Constant */
.nd { color: #AA22FF } /* Name.Decorator */
.ni { color: #717171; font-weight: bold } /* Name.Entity */
.ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.nf { color: #0000FF } /* Name.Function */
.nl { color: #767600 } /* Name.Label */
.nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.nt { color: #008000; font-weight: bold } /* Name.Tag */
.nv { color: #19177C } /* Name.Variable */
.ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.w { color: #bbbbbb } /* Text.Whitespace */
.mb { color: #666666 } /* Literal.Number.Bin */
.mf { color: #666666 } /* Literal.Number.Float */
.mh { color: #666666 } /* Literal.Number.Hex */
.mi { color: #666666 } /* Literal.Number.Integer */
.mo { color: #666666 } /* Literal.Number.Oct */
.sa { color: #BA2121 } /* Literal.String.Affix */
.sb { color: #BA2121 } /* Literal.String.Backtick */
.sc { color: #BA2121 } /* Literal.String.Char */
.dl { color: #BA2121 } /* Literal.String.Delimiter */
.sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.s2 { color: #BA2121 } /* Literal.String.Double */
.se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.sh { color: #BA2121 } /* Literal.String.Heredoc */
.si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.sx { color: #008000 } /* Literal.String.Other */
.sr { color: #A45A77 } /* Literal.String.Regex */
.s1 { color: #BA2121 } /* Literal.String.Single */
.ss { color: #19177C } /* Literal.String.Symbol */
.bp { color: #008000 } /* Name.Builtin.Pseudo */
.fm { color: #0000FF } /* Name.Function.Magic */
.vc { color: #19177C } /* Name.Variable.Class */
.vg { color: #19177C } /* Name.Variable.Global */
.vi { color: #19177C } /* Name.Variable.Instance */
.vm { color: #19177C } /* Name.Variable.Magic */
.il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body>
<h2>Issue 0208: Ambiguity in initialization</h2>
<p><strong>This issue has been automatically converted from the original issue lists and some formatting may not have been preserved.</strong></p>
<p>Authors: Clive Feather (UK)<br />
Date: 1999-09-06<br />
Reference document: <a href="https://www.open-std.org/jtc1/sc22/wg14/www/docs/n892.htm">ISO/IEC WG14 N892</a><br />
Submitted against: C99<br />
Status: Fixed<br />
Fixed in: C99 TC1<br />
Converted from: <a href="https://www.open-std.org/jtc1/sc22/wg14/www/docs/summary-c99.htm">summary-c99.htm</a>, <a href="https://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_208.htm">dr_208.htm</a></p>
<h3>Summary</h3>
<p>When there is more than one initializer for the same object it is not clear
whether both initializers are actually evaluated. Wording changes are proposed
to clarify this.</p>
<h3>Details</h3>
<p>Subclause 6.7.8 paragraph 19 reads:</p>
<blockquote>
<p>The initialization shall occur in initializer list order, each initializer
provided for a particular subobject overriding any previously listed initializer
for the same subobject; all subobjects that are not initialized explicitly shall
be initialized implicitly the same as objects that have static storage duration.</p>
</blockquote>
<p>Paragraph 23 reads:</p>
<blockquote>
<p>The order in which any side effects occur among the initialization list
expressions is unspecified.</p>
</blockquote>
<p>If the same object is initialized twice, as in:</p>
<blockquote>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #B00040">int</span><span style="color: #bbbbbb"> </span>a<span style="color: #bbbbbb"> </span>[<span style="color: #666666">2</span>]<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"> </span>f<span style="color: #bbbbbb"> </span>(<span style="color: #666666">0</span>),<span style="color: #bbbbbb"> </span>f<span style="color: #bbbbbb"> </span>(<span style="color: #666666">1</span>),<span style="color: #bbbbbb"> </span>[<span style="color: #666666">0</span>]<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>f<span style="color: #bbbbbb"> </span>(<span style="color: #666666">2</span>)<span style="color: #bbbbbb"> </span>};
</pre></div>

</blockquote>
<p>the term "overriding" could be taken to mean that the first initializer is
ignored completely, or it could be taken to mean that the expression is
evaluated and then discarded. The proposed wording change assumes the latter.</p>
<h3>Suggested Technical Corrigendum</h3>
<p>Replace 6.7.8 paragraph 23 with:</p>
<blockquote>
<p>All the initialization list expressions are evaluated, even if the resulting
value will be overridden, but the order in which any side effects occur is
unspecified.</p>
</blockquote>
<hr />
<p>Comment from WG14 on 2000-11-02:</p>
<h3>Committee Response</h3>
<p>The question asks about the expression</p>
<blockquote>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #B00040">int</span><span style="color: #bbbbbb"> </span>a<span style="color: #bbbbbb"> </span>[<span style="color: #666666">2</span>]<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"> </span>f<span style="color: #bbbbbb"> </span>(<span style="color: #666666">0</span>),<span style="color: #bbbbbb"> </span>f<span style="color: #bbbbbb"> </span>(<span style="color: #666666">1</span>),<span style="color: #bbbbbb"> </span>[<span style="color: #666666">0</span>]<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>f<span style="color: #bbbbbb"> </span>(<span style="color: #666666">2</span>)<span style="color: #bbbbbb"> </span>};
</pre></div>

</blockquote>
<p>and the meaning of the wording</p>
<blockquote>
<p>each initializer provided for a particular subobject overriding any previously
listed initializer for the same subobject;</p>
</blockquote>
<p>It was the intention of WG14 that the call <code>f(0)</code> might, but need not, be made
when <code>a</code> is initialized. If the call <em>is</em> made, the order in which <code>f(0)</code> and
<code>f(2)</code> occur is unspecified (as is the order in which <code>f(1)</code> occurs relative to
both of these). Whether or not the call is made, the result of <code>f(2)</code> is used to
initialize <code>a[0]</code>.</p>
<p>The wording of paragraph 23:</p>
<blockquote>
<p>The order in which any side effects occur among the initialization list
expressions is unspecified.</p>
</blockquote>
<p>should be taken to only apply to those side effects which actually occur.</p>
<h3>Technical Corrigendum</h3>
<p>In 6.7.8 paragraph 19, attach a footnote to "the same subobject":</p>
<blockquote>
<p>[*] Any initializer for the subobject which is overridden and so not used to
initialize that subobject might not be evaluated at all.</p>
</blockquote>

</body>
</html>
