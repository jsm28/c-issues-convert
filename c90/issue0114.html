<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>C issue 0114: Initialization of multi-dimensional char array object questions</title>
<style>
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #ffffcc }
.c { color: #3D7B7B; font-style: italic } /* Comment */
.err { border: 1px solid #FF0000 } /* Error */
.k { color: #008000; font-weight: bold } /* Keyword */
.o { color: #666666 } /* Operator */
.ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.cp { color: #9C6500 } /* Comment.Preproc */
.cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.gd { color: #A00000 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.gr { color: #E40000 } /* Generic.Error */
.gh { color: #000080; font-weight: bold } /* Generic.Heading */
.gi { color: #008400 } /* Generic.Inserted */
.go { color: #717171 } /* Generic.Output */
.gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.gt { color: #0044DD } /* Generic.Traceback */
.kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.kp { color: #008000 } /* Keyword.Pseudo */
.kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.kt { color: #B00040 } /* Keyword.Type */
.m { color: #666666 } /* Literal.Number */
.s { color: #BA2121 } /* Literal.String */
.na { color: #687822 } /* Name.Attribute */
.nb { color: #008000 } /* Name.Builtin */
.nc { color: #0000FF; font-weight: bold } /* Name.Class */
.no { color: #880000 } /* Name.Constant */
.nd { color: #AA22FF } /* Name.Decorator */
.ni { color: #717171; font-weight: bold } /* Name.Entity */
.ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.nf { color: #0000FF } /* Name.Function */
.nl { color: #767600 } /* Name.Label */
.nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.nt { color: #008000; font-weight: bold } /* Name.Tag */
.nv { color: #19177C } /* Name.Variable */
.ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.w { color: #bbbbbb } /* Text.Whitespace */
.mb { color: #666666 } /* Literal.Number.Bin */
.mf { color: #666666 } /* Literal.Number.Float */
.mh { color: #666666 } /* Literal.Number.Hex */
.mi { color: #666666 } /* Literal.Number.Integer */
.mo { color: #666666 } /* Literal.Number.Oct */
.sa { color: #BA2121 } /* Literal.String.Affix */
.sb { color: #BA2121 } /* Literal.String.Backtick */
.sc { color: #BA2121 } /* Literal.String.Char */
.dl { color: #BA2121 } /* Literal.String.Delimiter */
.sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.s2 { color: #BA2121 } /* Literal.String.Double */
.se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.sh { color: #BA2121 } /* Literal.String.Heredoc */
.si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.sx { color: #008000 } /* Literal.String.Other */
.sr { color: #A45A77 } /* Literal.String.Regex */
.s1 { color: #BA2121 } /* Literal.String.Single */
.ss { color: #19177C } /* Literal.String.Symbol */
.bp { color: #008000 } /* Name.Builtin.Pseudo */
.fm { color: #0000FF } /* Name.Function.Magic */
.vc { color: #19177C } /* Name.Variable.Class */
.vg { color: #19177C } /* Name.Variable.Global */
.vi { color: #19177C } /* Name.Variable.Instance */
.vm { color: #19177C } /* Name.Variable.Magic */
.il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body>
<h2>Issue 0114: Initialization of multi-dimensional <code>char</code> array object questions</h2>
<p><strong>This issue has been automatically converted from the original issue lists and some formatting may not have been preserved.</strong></p>
<p>Authors: Ron Guilmette, WG14<br />
Date: 1993-12-03<br />
Submitted against: C90<br />
Status: Closed<br />
Converted from: <a href="https://www.open-std.org/jtc1/sc22/wg14/www/docs/dr.htm">dr.htm</a>, <a href="https://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_114.html">dr_114.html</a></p>
<p>ANSI/ISO C Defect Report #rfg21:</p>
<p>Subject: Initialization of multi-dimensional <code>char</code> array objects.</p>
<p>a) Does the following code involve usage which requires a diagnostic from a
conforming implementation?</p>
<p>b) Does the following code involve usage which renders the code itself not
strictly conforming?</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #B00040">char</span><span style="color: #bbbbbb"> </span>array2[<span style="color: #666666">2</span>][<span style="color: #666666">5</span>]<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"> </span><span style="color: #BA2121">&quot;defghi&quot;</span><span style="color: #bbbbbb"> </span>};<span style="color: #bbbbbb">       </span><span style="color: #3D7B7B; font-style: italic">/* ? */</span>
</pre></div>

<p>Background:</p>
<p>Subclause 6.5.7 (<strong>Constraints</strong>):</p>
<blockquote>
<p>There shall be no more initializers in an initializer list than there are
objects to be initialized.</p>
</blockquote>
<p>Subclause 6.5.7:</p>
<blockquote>
<p>An array of character type may be initialized by a character string literal,
optionally enclosed in braces.</p>
</blockquote>
<p>Subclause 6.5.7 (examples):</p>
<blockquote>
<p>... It defines a three-dimensional array object; ...</p>
</blockquote>
<p>It appears that many existing compilers seem to feel the the code example shown
above violates the “no more initializers” constraint (quoted above) which is
given in subclause 6.5.7.</p>
<p>Note however that the <em>entire</em> two-dimensional array object being initialized
consists of exactly 2*5 = 10 individual <code>char</code> objects, whereas the
initializer itself only consists of 7 individual <code>char</code> values (if one counts
the terminating null byte). Thus, it would appear that these existing
implementations are in fact <em>wrong</em> in rejecting the above code, and that such
usage is in fact strictly conforming.</p>
<p>I ask the Committee to unambiguously either confirm or refute that position.</p>
<hr />
<p>Comment from WG14 on 1997-09-23:</p>
<h3>Response</h3>
<p>a) Yes, a diagnostic is required.</p>
<p>b) Yes, this renders the program not strictly conforming.</p>
<p>Note that initialization of an array of character type by a string literal is a
special case, described in subclause 6.5.7.</p>
<p>The phrases “two-dimensional array” and “three-dimensional array” are merely
used for convenience. The <strong>Semantics</strong> section on array declarators (subclause
6.5.4.2) and the syntax specification in the section on declarations (subclause
6.5.4) clearly show that array types must be declared with one index. Thus, an
array which has two indices must be considered an “array of array of type.”</p>
<p>Since this is the case, the <strong>Semantics</strong> description for initializing
aggregates and subaggregates in subclause 6.5.7 applies. This description states</p>
<blockquote>
<p>If the initializer of a subaggregate or the first member of the contained union
begins with a left brace, the initializers enclosed by that brace and its
matching right brace initialize the members of the subaggregate or the first
member of the contained union.</p>
</blockquote>
<p>Thus, in the example, the string must be applied only to the first element of
the two-element array (which is an array of 5 characters). Since the initializer
contains 6 characters, it violates the constraint of the same section which
states:</p>
<blockquote>
<p>There shall be no more initializers in an initializer list than there are
objects to be initialized.</p>
</blockquote>

</body>
</html>
