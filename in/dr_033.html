<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML><HEAD><TITLE>Defect Report #033</TITLE></HEAD><BODY>
<H2>Defect Report #033</H2>

<P><B>Submission Date</B>: 10 Dec 92 <BR>
<B>Submittor</B>: WG14 <BR>
<B>Source</B>: X3J11/91-037 (Mike Vermeulen) <BR>
<B>Question</B> 1 <BR>
Is a conforming implementation required to diagnose all violations of ``shall''
and ``shall not'' statements in the standard, even if those statements
occur outside of a section labeled <B>Constraints</B>? <BR>
An example that illustrates this question is: <BR>
<B><TT>struct s { char field:1; };</TT></B> 
<BR>
This fragment violates a statement
in subclause 6.5.2.1 on page 60, line 30: ``A bit-field shall have a type
that is a qualified or unqualified version of one of <B><TT>int</TT></B>,
<B><TT>unsigned int</TT></B>, or <B><TT>signed int</TT></B>.'' Must a conforming
implementation issue a diagnostic for this violation of ``shall?'' <BR>
Following are two different ways in which the C Standard has been interpreted.
These interpretations came up during discussions over NIST conformance
tests for an ANSI-C FIPS. I would like to ask the Committee for an interpretation
of this issue, perhaps based on one or both of the interpretations given.
<BR>
<B>Suggested Interpretation #1</B>: <BR>
Clause 3 <B>Definitions and conventions</B> states in the very beginning:
``In this International Standard, `shall' is to be interpreted as a requirement
on an implementation or on a program; conversely, `shall not' is to be
interpreted as a prohibition.'' <BR>
Therefore <I>every</I> ``shall'' is viewed as testable. The question is
what happens if a ``shall'' is violated. <BR>
Subclause 5.1.1.3 <B>Diagnostics</B> provides the answer: ``A conforming
implementation shall produce at least one diagnostic message (identified
in an implementation-defined manner) for every translation unit that contains
a violation of <I>any syntax rule</I> or <I>constraint.</I> Diagnostic
messages <I>need not be</I> produced in other circumstances.'' (emphasis
added) <BR>
Therefore every violation of a ``shall'' should be treated as a failure
to meet the requirements of the C Standard (first definition). Any violation
of syntax rules, semantic rules, or sections labeled as <B>Constraints</B>
should therefore generate a diagnostic. <BR>
According to this interpretation, a diagnostic should be produced for the
example given above. <BR>
<B>Suggested Interpretation #2</B>: <BR>
Subclause 5.1.1.3 states that diagnostics must be produced ``for every
translation unit that contains a violation of any syntax rule or constraint.
Diagnostic messages need not be produced in other circumstances.'' <BR>
<I>Syntax rules</I> are those items listed in the <B>Syntax</B> sections
of the standard. <I>Constraints</I> are those items listed in the <B>Constraints</B>
sections of the standard. <BR>
The C Standard specifies in clause 3, page 3, lines 12-13 that when the
words ``shall'' or ``shall not'' appearing outside of a constraint are
violated, the behavior is undefined. <BR>
For undefined behavior, the C Standard specifies in clause 3, page 3, lines
6-7 that the standard ``imposes no requirements.'' Thus a conformance suite
should not test for the words ``shall'' or ``shall not'' outside of a <B>Constraints</B>
section, since the standard imposes no requirements. <BR>
According to this interpretation, the C Standard imposes no requirements
on a conforming implementation for the program fragment above. A conforming
implementation could choose to accept this program (see also Footnote 6
to subclause 5.1.1.3 on page 6), it could issue a diagnostic, or have any
other behavior. <BR>
<B>Response</B> <BR>
Concerning a violation of subclause 6.5.2.1, <B>Semantics</B>, page 60,
line 30: No diagnostic is required; this is undefined behavior. It is not
a violation of a constraint or syntax. <BR>
Concerning a violation of clause 3, page 2, lines 2-3, No diagnostic is
required. <BR>
Suggested Interpretation #2 is the correct one. <BR>
Conformance to FIPS is beyond the scope of WG14. We can't comment on this.
<BR>
</P>
<A HREF="dr_032.html">Previous Defect Report</A>
&lt; - &gt; 
<A HREF="dr_034.html">Next Defect Report</A>
</BODY></HTML>
