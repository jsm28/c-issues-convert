<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<html>
<head>
  <meta name="generator" content=
  "HTML Tidy for Mac OS X (vers 1st December 2004), see www.w3.org">

  <title>Defect report #336</title>
</head>

<body>
  <h2 align="center">Defect Report #336</h2><a href=
  "dr_335.htm">Previous Defect Report</a> &lt; - &gt; <a href=
  "dr_337.htm">Next Defect Report</a>

  <p><br>
  <b>Submitter:</b>&nbsp;Stoughton (US)<br>
  <b>Submission Date:</b>&nbsp;2007-02-01<br>
  <!-- yyyy-mm-dd -->
   <b>Source:</b>&nbsp;The Austin Group<br>
  <b>Reference Document:</b>&nbsp; <a href=
  "http://www.opengroup.org/austin/aardvark/latest/xbdbug2.txt">2004:XBD
  ERN 83</a><br>
  <b>Version:</b>&nbsp;1.3<br>
  <b>Date:</b>&nbsp;2007-10-10<br>
  <b>Subject:</b>&nbsp;<code><b>TMP_MAX</b></code></p>

  <p><b>Summary:</b> What does <code><b>TMP_MAX</b></code> actually
  indicate?</p>

  <p>This is a potential defect forwarded from the Austin
  Group.</p>

  <p>There is a conflict between POSIX.1 and C99 over the
  description of <code>TMP_MAX</code>. POSIX.1 describes it as:</p>

  <blockquote>
    "Minimum number of unique filenames generated by
    <code>tmpnam()</code>. Maximum number of times an application
    can call <code>tmpnam()</code> reliably."
  </blockquote>C99 (17.19.1, para 3) says it is

  <blockquote>
    "the maximum number of unique file names that can be generated
    by the <code>tmpnam</code> function".
  </blockquote>

  <p>That is to say, for POSIX, it is not an error for
  <code>tmpnam()</code> to not fail when called
  <code>TMP_MAX+1</code> times, while it is implied by the C
  standard that it must fail.</p>

  <p>POSIX goes on to state:</p>

  <blockquote>
    "If <code>tmpnam()</code>is called more than {TMP_MAX} times,
    the behavior is implementation-defined."
  </blockquote>

  <p>It should also be noted that the <code>tmpfile</code> function
  (7.19.4.3) also uses <code>TMP_MAX</code>, but as a minimum
  maximum:</p>

  <blockquote>
    "It should be possible to open at least TMP_MAX temporary files
    during the lifetime of the program (this limit may be shared
    with tmpnam)"
  </blockquote>

  <p><b>Suggested Technical Corrigendum</b><br></p>

  <p>Change 7.19.1 para 3 from:</p>

  <blockquote>
    the maximum number of unique file names that can be generated
    by the tmpnam function".
  </blockquote>

  <p>to:</p>

  <blockquote>
    the minimum number of unique file names that can be generated
    by the tmpnam function".
  </blockquote>

  <p>Also, at 7.19.4.4 p2, change</p>

  <blockquote>
    "The function is potentially capable of generating TMP_MAX
    different strings, but any or all of them may already be in use
    by existing files and thus not be suitable return values."
  </blockquote>to

  <blockquote>
    "The function is potentially capable of generating at least
    TMP_MAX different strings, but any or all of them may already
    be in use by existing files and thus not be suitable return
    values. It is implementation defined if <code>tmpnam</code> can
    generate more than TMP_MAX different strings."
  </blockquote>
  <hr>
  <!-- Entires below the line by WG14 only. -->

  <p><b>Committee Discussion</b> (for history only)</p>

  <p><b>Proposed Technical Corrigendum</b><br></p>

  <p>Change 7.19.1 para 3 from:</p>

  <blockquote>
    the maximum number of unique file names that can be generated
    by the tmpnam function".
  </blockquote>

  <p>to:</p>

  <blockquote>
    the minimum number of unique file names that can be generated
    by the tmpnam function".
  </blockquote>

  <p>Also, at 7.19.4.4 p2, change</p>

  <blockquote>
    "The function is potentially capable of generating TMP_MAX
    different strings, but any or all of them may already be in use
    by existing files and thus not be suitable return values."
  </blockquote>to

  <blockquote>
    "The function is potentially capable of generating at least
    TMP_MAX different strings, but any or all of them may already
    be in use by existing files and thus not be suitable return
    values."
  </blockquote><a href="dr_335.htm">Previous Defect Report</a> &lt;
  - &gt; <a href="dr_337.htm">Next Defect Report</a>
</body>
</html>
