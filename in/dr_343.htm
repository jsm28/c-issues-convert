<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<html>
<head>
  <meta name="generator" content=
  "HTML Tidy for Mac OS X (vers 1st December 2004), see www.w3.org">

  <title>Defect report #343</title>
</head>

<body>
  <h2 align="center">Defect Report #343</h2><a href=
  "dr_342.htm">Previous Defect Report</a> &lt; - &gt; <a href=
  "dr_344.htm">Next Defect Report</a>

  <p><br>
  <b>Submitter: Joseph Myers (UK)</b><br>
  <b>Submission Date: 2007-03-24</b><br>
  <b>Source: Joseph Myers &lt;joseph@codesourcery.com&gt;</b><br>
  <b>Reference Document:</b> <a href=
  "http://www.dkuug.dk/JTC1/SC22/WG14/www/docs/n1224.htm">ISO/IEC
  WG14 N1224</a><br>
  <b>Version:</b> 1.1<br>
  <b>Date: 2007-09-07</b><br>
  <b>Subject: Initializing qualified wchar_t arrays</b></p>

  <p><b>Summary</b></p>

  <p>6.7.8 paragraph 15 says:</p>

  <blockquote>
    [#15] An array with element type compatible with
    <code>wchar_t</code> may be initialized by a wide string
    literal, optionally enclosed in braces. [...]
  </blockquote>

  <p>What of arrays with element type a qualified version of
  <code>wchar_t</code>? Is</p>
  <pre>
    #include &lt;stddef.h&gt;
    const wchar_t x[] = L"foo";
</pre>

  <p>valid? Surely it must be intended to be, but the type
  <code>const wchar_t</code> isn't compatible with
  <code>wchar_t</code>.</p>

  <p>(The validity for character strings (paragraph 14) depends on
  "character type" including qualified character types. The
  definition of character types in 6.2.5 paragraph 15 does not
  mention qualified types. Other parts of the Standard also make
  more sense if "character type" is taken to include qualified
  character types; for example, 6.5 paragraph 7 of which the last
  point says "a character type" but the first four points come in
  matching pairs for qualified and unqualified types, and 6.3.2.3
  paragraph 7.)</p>

  <p><b>Suggested Technical Corrigendum</b><br>
  6.7.8 paragraph 15, change "<code>wchar_t</code>" to "a qualified
  or unqualified version of <code>wchar_t</code>".</p>
  <hr>

  <p><b>Proposed Technical Corrigendum</b><br></p>

  <p>Change 6.7.8 paragraph 15:</p>

  <blockquote>
    "<code>wchar_t</code>"
  </blockquote>to

  <blockquote>
    "a qualified or unqualified version of <code>wchar_t</code>".
  </blockquote>

  <p><br>
  <a href="dr_342.htm">Previous Defect Report</a> &lt; - &gt;
  <a href="dr_344.htm">Next Defect Report</a></p>
</body>
</html>
