<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
  <head>
    <meta name="generator" content=
    "HTML Tidy for Windows (vers 1st August 2002), see www.w3.org">

    <title>Defect report #259</title>
  </head>

  <body bgcolor="#FFFFFF">
    <h2 align="center">Defect Report #259</h2>
    <a href="dr_258.htm">Previous Defect Report</a> &lt; - &gt; <a
    href="dr_260.htm">Next Defect Report</a> 

    <p><br>
     <b>Submitter:</b> UK C Panel<br>
     <b>Submission Date:</b> 2001-09-07<br>
     <b>Source:</b> Clive D.W. Feather &lt;clive@demon.net&gt;<br>
     <b>Version:</b> 1.1<br>
     <b>Date:</b> 2002-03-06<br>
     <b>Subject:</b> macro invocations with no arguments</p>
    <b>Problem</b> 

    <p>Consider the code:</p>
<pre>
<tt><b>   #define m0()  replacement
    #define m1(x) begin x end
    m0() m1()
</b></tt>
</pre>

    <p>The number of arguments in a macro invocation is defined by
    6.10.3#11:</p>

    <blockquote>
      <p>[#11] The sequence of preprocessing tokens bounded by the
      outside-most matching parentheses forms the list of arguments
      for the function-like macro. The individual arguments within
      the list are separated by comma preprocessing tokens, but
      comma preprocessing tokens between matching inner parentheses
      do not separate arguments.</p>
    </blockquote>

    <p>while 6.10.3#4 reads:</p>

    <blockquote>
      <p>[#4] If the identifier-list in the macro definition does
      not end with an ellipsis, the number of arguments (including
      those arguments consisting of no preprocessing tokens) in an
      invocation of a function-like macro shall equal the number of
      parameters in the macro definition. Otherwise, there shall be
      more arguments in the invocation than there are parameters in
      the macro definition (excluding the ...). There shall exist a
      ) preprocessing token that terminates the invocation.</p>
    </blockquote>

    <p>Now:</p>

    <table summary="requirement of 6.10.3">
      <tr>
        <td><b>EITHER:</b></td>

        <td>the invocation of <tt><b>m0</b></tt> has a single
        argument,</td>
      </tr>

      <tr>
        <td><b>OR:</b></td>

        <td>the invocation of <tt><b>m1</b></tt> has no
        arguments,</td>
      </tr>
    </table>

    <p>and in either case the requirement of 6.10.3#4 is
    violated.</p>

    <p>This is clearly not the intent.</p>

    <p><b>Suggested Technical Corrigendum</b></p>

    <p>Append to 6.10.3#4:</p>

    <blockquote>
      <p>If the invocation has no preprocessing tokens between the
      parentheses, this shall count as one argument unless the
      macro definition has neither an identifier list nor an
      ellipsis, in which case it shall count as no arguments.</p>
    </blockquote>
    <hr>

    <p><b>Committee Response</b></p>

    <p>The standard is clear enough, and no change is needed.</p>

    <p><br>
     <a href="dr_258.htm">Previous Defect Report</a> &lt; - &gt; <a
    href="dr_260.htm">Next Defect Report</a></p>
  </body>
</html>

